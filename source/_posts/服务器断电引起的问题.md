---
title: 利用fsck修复linux文件系统
date: 2018-11-9 10:42:00
tags: [Linux]
---

{% cq %}
UNEXPECTED INCONSISTENCY: RUN fsck MANUALLY
自己公司的服务器, 如果遭遇断电或者异常重启导致了以上界面
{% endcq %}

<!-- more -->

## fsck

fsck [-sACVRP] [-t fstype] [--] [fsck-options] filesys [...]

- filesys: device 名称(eg./dev/sda1)，mount 点 (eg. / 或 /usr)
- t: 给定档案系统的型式，若在 /etc/fstab 中已有定义或 kernel 本身已支援的则不需加上此参数
- s: 依序一个一个地执行 fsck 的指令来检查
- A: 对/etc/fstab 中所有列出来的 partition 做检查
- C: 显示完整的检查进度
- d: 列印 e2fsck 的 debug 结果
- p: 同时有 -A 条件时，同时有多个 fsck 的检查一起执行
- R: 同时有 -A 条件时，省略 / 不检查
- V: 详细显示模式
- a: 如果检查有错则自动修复
- r: 如果检查有错则由使用者回答是否修复

```
检查并修复
fsck -C /dev/mapper/{xxx}

如果检查了每个磁盘均没有发现错误, 
可能是没有记录发生过错误,主动跳过。
要知道正常T级的磁盘检查7-8个小时也很正常。

我们加上-f 强制检查细节
fsck -C -f  /dev/mapper/{xxx}
```